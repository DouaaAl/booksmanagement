<h1 id="title">Manage Books</h1>
<form [formGroup]="productForm" (submit)="addProduct($event)" id="filter" action="">
    <input formControlName="name" type="text" placeholder="Name...">
    <input formControlName="description" type="text" placeholder="Description...">
    <input formControlName="price" type="text" placeholder="Price...">
    <select formControlName="available">
        <option value="available">Available</option>
        <option value="unavailable">Unavailable</option>
    </select>
    <select formControlName="categoryId">
        @for (category of categories; track category.id){
            <option [value]="category.id">{{category.name}}</option>
        }
    </select>

    <button type="submit">Add Book</button>
</form>

<section id="table">
    <ul >
        <li>
            <div class="seperate-grid">
                <h3>Price</h3>
                <h3>Category Id</h3>
                <h3>Name</h3>
                <h3>Status</h3>
                <h3>Description</h3>
            </div>
            <div>
                <h3>Admin</h3>
            </div>          
        </li>
        @for (product of products; track product.id){
            <li>
                <div class="seperate-grid" *ngIf="getState(product.id)">
                    <h3>{{product.price}}</h3>
                    <h3>{{product.categoryId}}</h3>
                    <h3>{{product.name}}</h3>
                    <h3>{{product.status}}</h3>
                    <p>{{product.description}}</p>
                </div>
                <div *ngIf="getState(product.id)">
                    <img (click)="changeInfo(product.id)" src="dashboard/Settings.png" alt="">
                    <img (click)="deleteProduct(product.id)" src="dashboard/Delete.png" alt="">
                </div>
                <div *ngIf="!getState(product.id)">
                    <form [formGroup]="formAvailable" >
                        <input formControlName="newprice" placeholder="New Price" type="text">
                            <select formControlName="categoryId">
                                @for (category of categories; track category.id){
                                    <option [value]="category.id">{{category.name}}</option>
                                }
                            </select>      

                        <input formControlName="newname" placeholder="New Name" type="text">
                            <select formControlName="available">
                                <option value="available">Available</option>
                                <option value="unavailable">Unavailable</option>
                            </select>        

                        <input formControlName="description" placeholder="New Description" type="text">
                    </form>
                </div>
                <div *ngIf="!getState(product.id)" class="btn-class">
                    <button (click)="trueState(product.id, product.name, product.id, product.price, product.status, product.description)">Submit</button>
                </div>
            </li>
        }
    </ul>
</section>

<app-reload *ngIf="isLoading" />